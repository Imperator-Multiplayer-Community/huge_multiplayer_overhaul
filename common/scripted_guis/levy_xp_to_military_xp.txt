country_single_levy_xp_set_start_value_event = {
	scope = country

	saved_scopes = {
	}

	effect = {
		set_levy_starting_xp_effect = yes
	}
}

country_all_levy_xp_set_start_value_event = {
	scope = country

	saved_scopes = {
	}

	effect = {
		set_levy_starting_xp_effect = yes
	}
}

country_all_levy_xp_to_military_xp_event = {
	scope = country

	saved_scopes = {
	}

	ai_is_valid = {
		always = no
	}

	effect = {
		every_army = {
			limit = {
				has_legion_trigger = no
				AND = {
					exists = commander
					commander = {
						is_mercenary = no
					}
				}
				NOT = {
					any_sub_unit = {
						is_migration = yes
					}
				}
			}

			set_variable = {
				name = normalized_xp_percentage
				value = experience_percentage
			}

			save_scope_as = levy_unit

			if = {
				# only the governors unit gets levy xp otherwise it would be OP for tribes
				limit = {
					AND = {
						exists = commander
						commander = {
							OR = {
								is_governor = yes
								is_ruler = yes
							}
						}
					}
				}

				change_variable = {
					name = normalized_xp_percentage
					multiply = 100
				}

				# debug_log = "levy normalized [THIS.Var('normalized_xp_percentage').GetValue]"
				# debug_log = "levy start [THIS.Var('levy_start_xp').GetValue]"

				ROOT = {
					disband_levy_xp_effect = yes
				}
			}

			scope:levy_unit = {
				remove_variable = normalized_xp_percentage
				remove_variable = levy_start_xp
				destroy_unit = yes
			}
		}
	}
}